# وثيقة متطلبات المنتج (PRD)
## منصة حوكمة المعايير والشواهد للمعلمين

---

## 1. نظرة عامة على المنتج

### 1.1 ملخص تنفيذي
منصة رقمية شاملة لإدارة وتقييم أداء المعلمين من خلال نظام معايير أداء (KPIs) وشواهد مرتبطة. تهدف المنصة إلى توفير نظام موحد وشفاف لتقييم الأداء التعليمي وإدارة الشواهد بشكل رقمي.

### 1.2 الهدف من المنتج
- توفير نظام موحد لتقييم أداء المعلمين
- رقمنة عملية إدارة الشواهد والمعايير
- تحسين الشفافية والدقة في التقييم
- توفير تقارير وإحصائيات شاملة
- دعم اتخاذ القرارات بناءً على بيانات دقيقة

### 1.3 الجمهور المستهدف
- **المعلمون**: رفع الشواهد ومتابعة التقييمات
- **مديرو المدارس**: إدارة المعلمين ومراجعة الشواهد
- **مديرو النظام**: إدارة شاملة للمنصة والمعايير الرسمية

---

## 2. الأدوار والصلاحيات

### 2.1 مدير النظام (ADMIN)
**الصلاحيات:**
- إدارة المدارس (إضافة، تعديل، حذف، تفعيل/تعطيل)
- إدارة صفات الموظفين (Job Types)
- إدارة المعايير الرسمية (KPIs) على مستوى النظام
- إدارة الشواهد الرسمية (Evidence Items)
- إدارة حسابات مديري المدارس
- الوصول الكامل لجميع البيانات والتقارير
- إدارة الاشتراكات والمدة الزمنية للمدارس
- عرض إحصائيات شاملة على مستوى النظام

**القيود:**
- لا يمكنه رفع شواهد
- لا يمكنه تقييم شواهد المعلمين مباشرة

### 2.2 مدير المدرسة (SCHOOL_MANAGER)
**الصلاحيات:**
- إدارة معلمي المدرسة (إضافة، تعديل، حذف، تفعيل/تعطيل)
- إضافة معايير خاصة بالمدرسة (School KPIs)
- إضافة شواهد خاصة بالمدرسة
- مراجعة وتقييم الشواهد المرفوعة من المعلمين
- تعديل أوزان المعايير لكل صفة وظيفية
- تفعيل/تعطيل المعايير لكل صفة
- عرض تقارير وإحصائيات المدرسة
- عرض درجات جميع المعلمين في المدرسة
- عرض تفاصيل درجة معلم محدد

**القيود:**
- يقتصر على مدرسته فقط
- لا يمكنه تعديل المعايير الرسمية
- لا يمكنه رفع شواهد نيابة عن المعلمين

### 2.3 المعلم (TEACHER)
**الصلاحيات:**
- رفع الشواهد للمعايير المخصصة لصفته
- متابعة حالة الطلبات (قيد المراجعة، مقبولة، مرفوضة)
- إعادة رفع الشواهد المرفوضة بعد التعديل
- عرض لوحة تحكم شخصية مع:
  - الدرجة النهائية
  - درجات كل معيار
  - إحصائيات الشواهد (قيد المراجعة، مقبولة، مرفوضة)
  - رسوم بيانية للأداء

**القيود:**
- لا يمكنه تقييم شواهده
- لا يمكنه رؤية شواهد المعلمين الآخرين
- لا يمكنه تعديل المعايير أو الأوزان

---

## 3. المتطلبات الوظيفية

### 3.1 إدارة المستخدمين والمصادقة

#### 3.1.1 تسجيل الدخول
- **المتطلبات:**
  - تسجيل دخول آمن باستخدام اسم المستخدم وكلمة المرور
  - استخدام JWT tokens للمصادقة
  - حفظ الجلسة لمدة 24 ساعة
  - إمكانية تسجيل الخروج
  - التحقق من قوة كلمة المرور (8+ أحرف، حروف كبيرة وصغيرة، أرقام)
  - رسائل خطأ واضحة بالعربية

- **قواعد العمل:**
  - بعد تسجيل الدخول الناجح، يتم توجيه المستخدم إلى لوحة التحكم المناسبة لدوره
  - في حالة فشل تسجيل الدخول، يتم عرض رسالة خطأ مناسبة
  - كلمات المرور مشفرة باستخدام bcrypt

#### 3.1.2 إدارة المستخدمين (للمدير والمدرسة)
- **إضافة مستخدم:**
  - اسم المستخدم (فريد)
  - كلمة المرور (مشفرة)
  - الاسم الكامل
  - الدور (ADMIN, SCHOOL_MANAGER, TEACHER)
  - المدرسة (للمعلمين ومديري المدارس)
  - الصفة الوظيفية (للمعلمين)
  - حالة الحساب (نشط/معطل)

- **تعديل مستخدم:**
  - تعديل جميع البيانات ما عدا اسم المستخدم
  - إمكانية تغيير الدور (بصلاحيات محددة)
  - إمكانية تعطيل/تفعيل الحساب

- **حذف مستخدم:**
  - حذف منطقي (تعطيل) بدلاً من الحذف الفعلي
  - الحفاظ على البيانات التاريخية

### 3.2 إدارة المدارس

#### 3.2.1 إدارة المدارس (للمدير فقط)
- **إضافة مدرسة:**
  - اسم المدرسة
  - حالة المدرسة (نشطة/معطلة)
  - تاريخ بداية الاشتراك
  - تاريخ نهاية الاشتراك

- **تعديل مدرسة:**
  - تعديل جميع البيانات
  - إمكانية تمديد الاشتراك

- **تعطيل/تفعيل مدرسة:**
  - عند التعطيل، يتم تعطيل جميع المستخدمين التابعين لها
  - عرض تحذير قبل التعطيل

- **عرض قائمة المدارس:**
  - جدول بجميع المدارس
  - فلترة حسب الحالة
  - بحث بالاسم
  - عرض عدد المعلمين لكل مدرسة

### 3.3 إدارة صفات الموظفين (Job Types)

#### 3.3.1 إدارة الصفات (للمدير فقط)
- **إضافة صفة:**
  - اسم الصفة الوظيفية
  - حالة الصفة (نشطة/معطلة)

- **تعديل صفة:**
  - تعديل الاسم والحالة

- **حذف صفة:**
  - التحقق من عدم وجود معلمين مرتبطين بالصفة
  - التحقق من عدم وجود معايير مرتبطة بالصفة

### 3.4 إدارة المعايير (KPIs)

#### 3.4.1 المعايير الرسمية (للمدير)
- **إضافة معيار رسمي:**
  - اسم المعيار
  - الصفة الوظيفية المرتبطة
  - الوزن الافتراضي (0-100)
  - الحد الأدنى لعدد الشواهد المقبولة المطلوبة
  - حالة المعيار (نشط/معطل)

- **تعديل معيار رسمي:**
  - تعديل جميع البيانات
  - التحقق من أن الوزن لا يتجاوز 100%

- **حذف معيار رسمي:**
  - التحقق من عدم وجود شواهد مرتبطة
  - حذف منطقي (تعطيل) بدلاً من الحذف الفعلي

#### 3.4.2 المعايير الخاصة بالمدرسة (لمدير المدرسة)
- **إضافة معيار خاص:**
  - نفس بيانات المعيار الرسمي
  - مرتبط بمدرسة محددة
  - يمكن ربطه بصفة وظيفية محددة

- **تعديل/حذف معيار خاص:**
  - نفس قواعد المعايير الرسمية
  - يقتصر على مدرسة المدير فقط

#### 3.4.3 إدارة الأوزان (لمدير المدرسة)
- **تعديل أوزان المعايير:**
  - لكل صفة وظيفية، يمكن تعديل أوزان المعايير
  - يجب أن يكون مجموع الأوزان للمعايير النشطة = 100%
  - إمكانية تفعيل/تعطيل معايير لكل صفة
  - عرض تحذير إذا كان المجموع لا يساوي 100%

- **قواعد العمل:**
  - الأوزان المخصصة تحل محل الأوزان الافتراضية
  - عند تعطيل معيار، يتم استبعاده من الحساب
  - عند تفعيل معيار، يجب التأكد من أن المجموع لا يتجاوز 100%

### 3.5 إدارة الشواهد (Evidence Items)

#### 3.5.1 الشواهد الرسمية (للمدير)
- **إضافة شاهد رسمي:**
  - اسم الشاهد
  - المعيار المرتبط
  - حالة الشاهد (نشط/معطل)

- **تعديل/حذف شاهد رسمي:**
  - نفس قواعد المعايير

#### 3.5.2 الشواهد الخاصة بالمدرسة (لمدير المدرسة)
- **إضافة شاهد خاص:**
  - مرتبط بمدرسة محددة
  - يمكن ربطه بمعيار رسمي أو خاص

### 3.6 رفع وتقييم الشواهد

#### 3.6.1 رفع الشواهد (للمعلم)
- **رفع شاهد جديد:**
  - اختيار المعيار
  - اختيار الشاهد من القائمة
  - رفع الملف (PDF, JPG, PNG, GIF, WEBP)
  - إضافة وصف اختياري
  - الحد الأقصى لحجم الملف: 10MB

- **قواعد العمل:**
  - يمكن رفع شاهد واحد لكل معيار في كل مرة
  - حالة الشاهد الافتراضية: قيد المراجعة (PENDING)
  - يتم حفظ الملف في `/public/uploads/evidence/`
  - اسم الملف يتم توليده بشكل فريد

- **إعادة رفع شاهد مرفوض:**
  - يمكن إعادة رفع الشاهد بعد التعديل
  - يتم إنشاء طلب جديد بنفس المعيار والشاهد

#### 3.6.2 تقييم الشواهد (لمدير المدرسة)
- **مراجعة الشاهد:**
  - عرض تفاصيل الشاهد المرفوع
  - عرض الملف المرفوع
  - عرض الوصف (إن وجد)

- **قبول الشاهد:**
  - إعطاء تقييم من 1 إلى 5
  - حفظ التقييم والوقت
  - تغيير الحالة إلى مقبول (ACCEPTED)
  - إرسال إشعار للمعلم

- **رفض الشاهد:**
  - إضافة سبب الرفض (إلزامي)
  - حفظ سبب الرفض والوقت
  - تغيير الحالة إلى مرفوض (REJECTED)
  - إرسال إشعار للمعلم

- **قواعد العمل:**
  - يمكن مراجعة الشواهد فقط لمعلمي مدرسة المدير
  - لا يمكن تعديل التقييم بعد الحفظ
  - يمكن رفض شاهد مقبول سابقاً (في حالات خاصة)

### 3.7 حساب الدرجات

#### 3.7.1 حساب درجة المعلم
- **الصيغة:**
  ```
  الدرجة النهائية = Σ (درجة المعيار × وزن المعيار) / Σ (أوزان المعايير)
  
  حيث:
  - درجة المعيار = متوسط تقييمات الشواهد المقبولة للمعيار
  - وزن المعيار = الوزن المخصص للمعيار في صفة المعلم
  ```

- **قواعد العمل:**
  - يتم حساب الدرجة بناءً على الشواهد المقبولة فقط
  - إذا لم يكن هناك شواهد مقبولة لمعيار، لا يتم احتسابه في الدرجة
  - يتم عرض تحذير إذا كان مجموع الأوزان لا يساوي 100%
  - الدرجة النهائية من 0 إلى 5

#### 3.7.2 عرض الدرجات
- **لوحة تحكم المعلم:**
  - الدرجة النهائية (من 5)
  - النسبة المئوية
  - شريط تقدم ملون حسب الأداء:
    - أخضر: ≥ 80%
    - أصفر: 60-79%
    - أحمر: < 60%
  - درجات كل معيار
  - رسم بياني لأداء المعايير
  - إحصائيات الشواهد

- **صفحة درجات المعلمين (لمدير المدرسة):**
  - جدول بجميع المعلمين
  - الدرجة النهائية لكل معلم
  - إمكانية البحث والفلترة
  - إمكانية تصدير البيانات

- **صفحة تفاصيل معلم (لمدير المدرسة):**
  - الدرجة النهائية
  - تفاصيل كل معيار:
    - اسم المعيار
    - الوزن
    - الدرجة
    - عدد الشواهد المقبولة
    - عدد الشواهد المرفوضة
  - رسم بياني تفصيلي

### 3.8 التقارير والإحصائيات

#### 3.8.1 لوحة تحكم المدير
- **إحصائيات عامة:**
  - عدد المدارس (نشطة/معطلة)
  - عدد المعلمين الإجمالي
  - عدد الشواهد المرفوعة
  - عدد الشواهد قيد المراجعة
  - عدد المعايير الرسمية
  - عدد الصفات الوظيفية

- **رسوم بيانية:**
  - توزيع المدارس حسب الحالة
  - توزيع المعلمين حسب المدارس
  - توزيع الشواهد حسب الحالة

#### 3.8.2 لوحة تحكم مدير المدرسة
- **إحصائيات المدرسة:**
  - عدد المعلمين
  - عدد الشواهد المرفوعة
  - عدد الشواهد قيد المراجعة
  - متوسط الدرجة النهائية للمعلمين
  - عدد المعايير الخاصة بالمدرسة

- **رسوم بيانية:**
  - توزيع الشواهد حسب الحالة
  - توزيع المعلمين حسب الصفة الوظيفية
  - متوسط الدرجات حسب الصفة

#### 3.8.3 لوحة تحكم المعلم
- **إحصائيات شخصية:**
  - عدد الشواهد قيد المراجعة
  - عدد الشواهد المقبولة
  - عدد الشواهد المرفوضة
  - الدرجة النهائية
  - درجات كل معيار

- **رسوم بيانية:**
  - رسم بياني عمودي لأداء المعايير
  - توزيع الشواهد حسب الحالة

### 3.9 نظام الإشعارات

#### 3.9.1 أنواع الإشعارات
- **EVIDENCE_SUBMITTED**: تم رفع شاهد جديد
- **EVIDENCE_ACCEPTED**: تم قبول شاهد
- **EVIDENCE_REJECTED**: تم رفض شاهد
- **TEACHER_ADDED**: تم إضافة معلم جديد
- **KPI_ADDED**: تم إضافة معيار جديد
- **EVIDENCE_ADDED**: تم إضافة شاهد جديد
- **WEIGHT_UPDATED**: تم تحديث الأوزان
- **SYSTEM_NOTIFICATION**: إشعارات النظام

#### 3.9.2 وظائف الإشعارات
- **عرض الإشعارات:**
  - قائمة بالإشعارات غير المقروءة
  - عداد للإشعارات الجديدة
  - إمكانية قراءة/عدم قراءة الإشعار
  - رابط مباشر للصفحة ذات الصلة

- **إرسال الإشعارات:**
  - تلقائي عند حدوث الأحداث المحددة
  - إشعارات فورية للمستخدمين المعنيين
  - حفظ الإشعارات في قاعدة البيانات

### 3.10 سجل الأنشطة (Activity Log)

#### 3.10.1 تسجيل الأنشطة
- **أنواع الأنشطة المسجلة:**
  - تسجيل الدخول/الخروج
  - إضافة/تعديل/حذف المستخدمين
  - إضافة/تعديل/حذف المدارس
  - إضافة/تعديل/حذف المعايير
  - رفع/تقييم الشواهد
  - تعديل الأوزان
  - أي إجراء مهم في النظام

- **معلومات السجل:**
  - المستخدم الذي قام بالإجراء
  - نوع الإجراء
  - التفاصيل
  - التاريخ والوقت

---

## 4. المتطلبات غير الوظيفية

### 4.1 الأمان

#### 4.1.1 المصادقة والتفويض
- **JWT Tokens:**
  - استخدام JWT tokens مع انتهاء صلاحية 24 ساعة
  - آلية refresh tokens للجلسات الطويلة
  - قائمة سوداء للـ tokens المسجلة الخروج

- **Role-Based Access Control (RBAC):**
  - صلاحيات محددة حسب الدور
  - التحقق من ملكية الموارد لمنع IDOR attacks
  - التحقق من الصلاحيات في كل طلب

#### 4.1.2 حماية CSRF
- توليد وفحص CSRF tokens لجميع الطلبات التي تغير الحالة
- استخدام SameSite Cookies في production
- تخزين آمن للـ CSRF tokens

#### 4.1.3 التحقق من المدخلات
- استخدام Zod schemas للتحقق من جميع المدخلات
- تنظيف جميع مدخلات المستخدم لمنع XSS
- التحقق من صحة UUIDs في جميع endpoints
- متطلبات قوة كلمة المرور

#### 4.1.4 أمان رفع الملفات
- التحقق من نوع الملف باستخدام magic bytes
- حد أقصى 10MB لحجم الملف
- تنظيف أسماء الملفات لمنع path traversal
- منع رفع ملفات خطيرة (.exe, .sh, .bat, etc.)
- التحقق من محتوى الملف

#### 4.1.5 معالجة الأخطاء
- إخفاء تفاصيل الأخطاء في production
- عدم عرض stack traces للـ clients
- رسائل خطأ واضحة بالعربية

### 4.2 الأداء

#### 4.2.1 سرعة الاستجابة
- وقت استجابة الصفحات الرئيسية: < 2 ثانية
- وقت استجابة API: < 500ms
- وقت تحميل الصور والملفات: < 3 ثوانٍ

#### 4.2.2 قواعد البيانات
- استخدام الفهارس (Indexes) للاستعلامات الشائعة
- استخدام فهارس مركبة للاستعلامات المعقدة
- تحسين الاستعلامات لتقليل عدد الطلبات

#### 4.2.3 التخزين المؤقت
- تخزين مؤقت للبيانات الثابتة
- تخزين مؤقت للاستعلامات الشائعة
- إعادة التحقق من البيانات عند التحديث

### 4.3 قابلية التوسع

#### 4.3.1 البنية التحتية
- دعم عدد كبير من المستخدمين المتزامنين
- دعم عدد كبير من المدارس
- دعم عدد كبير من الملفات المرفوعة

#### 4.3.2 قاعدة البيانات
- تصميم قاعدة بيانات قابل للتوسع
- استخدام pagination للقوائم الطويلة
- أرشفة البيانات القديمة

### 4.4 الموثوقية

#### 4.4.1 النسخ الاحتياطي
- نسخ احتياطي يومي لقاعدة البيانات
- نسخ احتياطي للملفات المرفوعة
- خطة استعادة في حالة الكوارث

#### 4.4.2 مراقبة النظام
- تسجيل جميع الأخطاء
- مراقبة الأداء
- تنبيهات للأخطاء الحرجة

### 4.5 سهولة الاستخدام

#### 4.5.1 الواجهة
- واجهة عربية كاملة مع دعم RTL
- تصميم متجاوب (Responsive) لجميع الأجهزة
- تصميم حديث وجذاب
- ألوان واضحة ومريحة للعين

#### 4.5.2 تجربة المستخدم
- تنقل سهل وواضح
- رسائل واضحة ومفيدة
- تأكيدات قبل الإجراءات الحرجة
- تعليمات وأدلة استخدام

---

## 5. المتطلبات التقنية

### 5.1 التقنيات المستخدمة

#### 5.1.1 Frontend
- **Next.js 14+**: إطار عمل React
- **TypeScript**: للبرمجة الآمنة
- **Tailwind CSS**: للتصميم
- **React Hook Form**: لإدارة النماذج
- **Zod**: للتحقق من البيانات
- **Chart.js**: للرسوم البيانية
- **Lucide React**: للأيقونات

#### 5.1.2 Backend
- **Node.js 18+**: بيئة التشغيل
- **Express**: إطار عمل الويب
- **Prisma**: ORM لقاعدة البيانات
- **MySQL**: قاعدة البيانات
- **JWT**: للمصادقة
- **bcrypt**: لتشفير كلمات المرور
- **Multer**: لرفع الملفات

#### 5.1.3 الأدوات
- **Git**: للتحكم في الإصدارات
- **ESLint**: لفحص الكود
- **Prettier**: لتنسيق الكود

### 5.2 البنية التحتية

#### 5.2.1 قاعدة البيانات
- **MySQL 8.0+**
- **الاسم**: TecherProgram
- **الترميز**: UTF-8
- **الفهارس**: على الأعمدة الشائعة

#### 5.2.2 التخزين
- **الملفات المرفوعة**: `/public/uploads/evidence/`
- **الحد الأقصى**: 10MB لكل ملف
- **الأنواع المدعومة**: PDF, JPG, PNG, GIF, WEBP

#### 5.2.3 البيئة
- **التطوير**: localhost:3000 (Frontend), localhost:5000 (Backend)
- **الإنتاج**: خادم مخصص مع SSL

### 5.3 API

#### 5.3.1 هيكل API
- **Base URL**: `/api`
- **المصادقة**: Bearer Token في Header
- **التنسيق**: JSON
- **الاستجابة**: JSON موحد

#### 5.3.2 Endpoints الرئيسية
- **المصادقة:**
  - `POST /api/auth/login` - تسجيل الدخول
  - `POST /api/auth/logout` - تسجيل الخروج
  - `GET /api/auth/me` - معلومات المستخدم الحالي

- **المستخدمين:**
  - `GET /api/users` - قائمة المستخدمين
  - `POST /api/users` - إضافة مستخدم
  - `PUT /api/users/:id` - تعديل مستخدم
  - `DELETE /api/users/:id` - حذف مستخدم

- **المدارس:**
  - `GET /api/schools` - قائمة المدارس
  - `POST /api/schools` - إضافة مدرسة
  - `PUT /api/schools/:id` - تعديل مدرسة
  - `DELETE /api/schools/:id` - حذف مدرسة

- **المعايير:**
  - `GET /api/kpis` - قائمة المعايير
  - `POST /api/kpis` - إضافة معيار
  - `PUT /api/kpis/:id` - تعديل معيار
  - `DELETE /api/kpis/:id` - حذف معيار

- **الشواهد:**
  - `GET /api/evidence` - قائمة الشواهد
  - `POST /api/evidence` - إضافة شاهد
  - `POST /api/submissions` - رفع شاهد
  - `PUT /api/submissions/:id/review` - تقييم شاهد

- **الدرجات:**
  - `GET /api/teachers/:id/score` - درجة معلم
  - `GET /api/schools/:id/scores` - درجات مدرسة

---

## 6. نماذج البيانات

### 6.1 User (المستخدم)
```typescript
{
  id: string (UUID)
  username: string (unique)
  password: string (hashed)
  name: string
  role: 'ADMIN' | 'SCHOOL_MANAGER' | 'TEACHER'
  schoolId: string? (UUID)
  jobTypeId: string? (UUID)
  status: boolean
  createdAt: DateTime
  updatedAt: DateTime
}
```

### 6.2 School (المدرسة)
```typescript
{
  id: string (UUID)
  name: string
  status: boolean
  subscriptionStart: DateTime?
  subscriptionEnd: DateTime?
  createdAt: DateTime
  updatedAt: DateTime
}
```

### 6.3 JobType (الصفة الوظيفية)
```typescript
{
  id: string (UUID)
  name: string
  status: boolean
  createdAt: DateTime
  updatedAt: DateTime
}
```

### 6.4 KPI (المعيار)
```typescript
{
  id: string (UUID)
  jobTypeId: string (UUID)
  name: string
  weight: number (0-100)
  minAcceptedEvidence: number?
  isOfficial: boolean
  schoolId: string? (UUID)
  createdAt: DateTime
  updatedAt: DateTime
}
```

### 6.5 EvidenceItem (الشاهد)
```typescript
{
  id: string (UUID)
  kpiId: string (UUID)
  name: string
  isOfficial: boolean
  schoolId: string? (UUID)
  createdAt: DateTime
  updatedAt: DateTime
}
```

### 6.6 EvidenceSubmission (رفع الشاهد)
```typescript
{
  id: string (UUID)
  teacherId: string (UUID)
  kpiId: string (UUID)
  evidenceId: string (UUID)
  fileUrl: string
  description: string?
  status: 'PENDING' | 'ACCEPTED' | 'REJECTED'
  rating: number? (1-5)
  rejectReason: string?
  reviewedAt: DateTime?
  createdAt: DateTime
  updatedAt: DateTime
}
```

### 6.7 SchoolJobTypeKPI (أوزان المعايير)
```typescript
{
  id: string (UUID)
  schoolId: string (UUID)
  jobTypeId: string (UUID)
  kpiId: string (UUID)
  weight: number (0-100)
  isActive: boolean
  createdAt: DateTime
  updatedAt: DateTime
}
```

---

## 7. سيناريوهات الاستخدام

### 7.1 سيناريو: رفع شاهد جديد (المعلم)
1. المعلم يسجل الدخول
2. ينتقل إلى صفحة "رفع شاهد جديد"
3. يختار الصفة الوظيفية (إذا كان لديه أكثر من صفة)
4. يختار المعيار من القائمة المنسدلة
5. يختار الشاهد من القائمة المنسدلة
6. يرفع الملف (PDF, JPG, PNG, GIF, WEBP)
7. يضيف وصفاً اختيارياً
8. يضغط على "رفع"
9. يتم حفظ الشاهد بحالة "قيد المراجعة"
10. يتم إرسال إشعار لمدير المدرسة

### 7.2 سيناريو: تقييم شاهد (مدير المدرسة)
1. مدير المدرسة يسجل الدخول
2. ينتقل إلى صفحة "مراجعة الشواهد"
3. يرى قائمة بالشواهد قيد المراجعة
4. يفتح شاهد معين
5. يعرض الملف المرفوع
6. يقرأ الوصف (إن وجد)
7. يختار إما:
   - **قبول**: يعطي تقييم من 1-5، يحفظ
   - **رفض**: يكتب سبب الرفض، يحفظ
8. يتم تحديث حالة الشاهد
9. يتم إرسال إشعار للمعلم
10. يتم تحديث درجة المعلم تلقائياً

### 7.3 سيناريو: إدارة الأوزان (مدير المدرسة)
1. مدير المدرسة يسجل الدخول
2. ينتقل إلى صفحة "إدارة الأوزان"
3. يختار الصفة الوظيفية
4. يرى قائمة بجميع المعايير المرتبطة بالصفة
5. يعدل أوزان المعايير
6. يفعّل/يعطّل معايير
7. يرى مجموع الأوزان في الوقت الفعلي
8. إذا كان المجموع ≠ 100%، يظهر تحذير
9. عند الحفظ، يتم التحقق من أن المجموع = 100%
10. يتم تحديث الدرجات تلقائياً

### 7.4 سيناريو: إضافة معيار رسمي (المدير)
1. المدير يسجل الدخول
2. ينتقل إلى صفحة "إدارة المعايير"
3. يضغط على "إضافة معيار جديد"
4. يملأ النموذج:
   - اسم المعيار
   - الصفة الوظيفية
   - الوزن الافتراضي
   - الحد الأدنى لعدد الشواهد المقبولة
5. يحفظ المعيار
6. يتم إضافة المعيار لجميع المدارس المرتبطة بالصفة
7. يتم إرسال إشعار لمديري المدارس

---

## 8. متطلبات الواجهة

### 8.1 التصميم العام
- **الألوان:**
  - اللون الأساسي: الأخضر الزمردي (Emerald)
  - اللون الثانوي: الأزرق (Blue)
  - الألوان الداعمة: الأصفر، الأحمر، الرمادي
- **الخطوط:**
  - خط عربي واضح وسهل القراءة
  - حجم الخط: 14px للجسم، 16px للعناوين
- **المسافات:**
  - مسافات مريحة بين العناصر
  - استخدام نظام Grid للتنظيم

### 8.2 المكونات الرئيسية
- **Header:**
  - شعار المنصة
  - اسم المستخدم
  - قائمة الإشعارات
  - زر تسجيل الخروج
- **Sidebar:**
  - قائمة التنقل حسب الدور
  - أيقونات واضحة
  - حالة نشطة للصفحة الحالية
- **Content Area:**
  - Breadcrumbs للتنقل
  - محتوى الصفحة
  - رسائل النجاح/الخطأ

### 8.3 الصفحات الرئيسية

#### 8.3.1 صفحة تسجيل الدخول
- نموذج بسيط وواضح
- حقول اسم المستخدم وكلمة المرور
- زر تسجيل الدخول
- رابط "نسيت كلمة المرور" (مستقبلاً)
- تصميم جذاب مع خلفية ملونة

#### 8.3.2 لوحة التحكم
- بطاقات إحصائية كبيرة وواضحة
- رسوم بيانية تفاعلية
- ألوان مختلفة حسب النوع
- أيقونات واضحة

#### 8.3.3 صفحات الإدارة
- جداول منظمة مع pagination
- أزرار إضافة/تعديل/حذف واضحة
- نماذج منظمة مع validation
- رسائل تأكيد قبل الحذف

#### 8.3.4 صفحة رفع الشواهد
- نموذج منظم خطوة بخطوة
- معاينة الملف قبل الرفع
- شريط تقدم للرفع
- رسائل نجاح/خطأ واضحة

---

## 9. متطلبات الأداء

### 9.1 أوقات الاستجابة
- **صفحات HTML**: < 2 ثانية
- **API Requests**: < 500ms
- **رفع الملفات**: < 10 ثوانٍ (حسب الحجم)
- **الاستعلامات المعقدة**: < 2 ثانية

### 9.2 الاستخدام المتزامن
- دعم 100+ مستخدم متزامن
- دعم 50+ مدرسة
- دعم 1000+ معلم

### 9.3 التخزين
- دعم 10,000+ ملف مرفوع
- حجم قاعدة البيانات: قابل للتوسع
- مساحة تخزين: حسب الحاجة

---

## 10. التحسينات المستقبلية

### 10.1 الميزات المخطط لها
- **نظام التصاريح المتقدم:**
  - تصاريح مخصصة لكل مستخدم
  - تصاريح على مستوى المهام

- **التقارير المتقدمة:**
  - تقارير قابلة للتخصيص
  - تصدير PDF/Excel
  - تقارير دورية تلقائية

- **نظام التعليقات:**
  - تعليقات على الشواهد
  - مناقشات بين المعلم ومدير المدرسة

- **نظام الإشعارات المتقدم:**
  - إشعارات بريد إلكتروني
  - إشعارات SMS
  - إشعارات push

- **نظام النسخ الاحتياطي:**
  - نسخ احتياطي تلقائي
  - استعادة سريعة

- **نظام التقييم المتقدم:**
  - تقييمات متعددة المراحل
  - تقييمات جماعية
  - معايير تقييم قابلة للتخصيص

- **لوحة تحكم متقدمة:**
  - تحليلات متقدمة
  - تنبؤات الأداء
  - توصيات تحسين

### 10.2 التحسينات التقنية
- **تحسين الأداء:**
  - استخدام Redis للتخزين المؤقت
  - تحسين استعلامات قاعدة البيانات
  - استخدام CDN للملفات الثابتة

- **الأمان:**
  - إضافة 2FA (Two-Factor Authentication)
  - تسجيل متقدم للأنشطة
  - فحص أمني تلقائي

- **التكامل:**
  - تكامل مع أنظمة إدارة المدارس الأخرى
  - API عامة للتكامل
  - webhooks للأحداث

---

## 11. معايير القبول

### 11.1 الاختبارات الوظيفية
- ✅ جميع الأدوار تعمل بشكل صحيح
- ✅ جميع الصفحات قابلة للوصول
- ✅ جميع النماذج تعمل بشكل صحيح
- ✅ حساب الدرجات دقيق
- ✅ رفع الملفات يعمل بشكل صحيح

### 11.2 الاختبارات الأمنية
- ✅ المصادقة والتفويض يعملان بشكل صحيح
- ✅ لا توجد ثغرات أمنية واضحة
- ✅ حماية CSRF فعالة
- ✅ رفع الملفات آمن

### 11.3 اختبارات الأداء
- ✅ أوقات الاستجابة ضمن المعايير
- ✅ النظام يعمل مع عدد كبير من المستخدمين
- ✅ قاعدة البيانات محسّنة

### 11.4 اختبارات الواجهة
- ✅ التصميم متجاوب على جميع الأجهزة
- ✅ الواجهة عربية بالكامل
- ✅ سهولة الاستخدام جيدة

---

## 12. الجدول الزمني

### 12.1 المرحلة الأولى (الأساسيات)
- ✅ نظام المصادقة
- ✅ إدارة المستخدمين
- ✅ إدارة المدارس
- ✅ إدارة المعايير والشواهد
- ✅ رفع وتقييم الشواهد
- ✅ حساب الدرجات

### 12.2 المرحلة الثانية (التحسينات)
- ✅ لوحات التحكم
- ✅ التقارير والإحصائيات
- ✅ نظام الإشعارات
- ✅ إدارة الأوزان

### 12.3 المرحلة الثالثة (المستقبلية)
- ⏳ التقارير المتقدمة
- ⏳ نظام التعليقات
- ⏳ التكامل مع أنظمة أخرى
- ⏳ تطبيق موبايل

---

## 13. المخاطر والتحديات

### 13.1 المخاطر التقنية
- **قاعدة البيانات:**
  - خطر: حجم البيانات الكبير
  - الحل: أرشفة البيانات القديمة

- **رفع الملفات:**
  - خطر: مساحة التخزين
  - الحل: ضغط الملفات، حذف الملفات القديمة

- **الأداء:**
  - خطر: بطء الاستعلامات المعقدة
  - الحل: تحسين الفهارس، استخدام التخزين المؤقت

### 13.2 المخاطر الأمنية
- **المصادقة:**
  - خطر: تسريب كلمات المرور
  - الحل: تشفير قوي، متطلبات قوة

- **رفع الملفات:**
  - خطر: رفع ملفات ضارة
  - الحل: فحص الملفات، منع الأنواع الخطيرة

### 13.3 المخاطر التشغيلية
- **النسخ الاحتياطي:**
  - خطر: فقدان البيانات
  - الحل: نسخ احتياطي يومي

- **الصيانة:**
  - خطر: توقف النظام
  - الحل: صيانة مجدولة، خطة استعادة

---

## 14. الخلاصة

هذه الوثيقة تغطي جميع متطلبات منصة حوكمة المعايير والشواهد للمعلمين. المنصة توفر نظاماً شاملاً لإدارة وتقييم أداء المعلمين من خلال معايير واضحة وشواهد رقمية.

المنصة مصممة لتكون:
- **آمنة**: مع حماية شاملة للبيانات
- **سهلة الاستخدام**: مع واجهة عربية واضحة
- **قابلة للتوسع**: لدعم عدد كبير من المستخدمين
- **موثوقة**: مع نسخ احتياطي ومراقبة

---

**تاريخ الإنشاء**: 2024
**آخر تحديث**: 2024
**الإصدار**: 1.0

